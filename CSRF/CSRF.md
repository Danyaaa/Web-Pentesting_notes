## Csrf "Cross Site Request Forgery "

- Force the user to make an action they don't want to do
- Circumvent the same origin policy 

### 3 conditions to make the attack possible :

​	1- Relevant action 

​	2- Cookie based session handling

​		- Relies on cookies 

​	3- No unpredictable request parameters (no guessing paramters)

--------

## [+] How to construct a CSRF attack and how to deliver ?

 - CSRF POC generatot in burp suite
    - it genertes a web site you control
    - induce the victim to vistit (email, msg, comment, ....)

---------------------------------

## Mitigation

​	1- include a csrf token 

​	2- Same site cookies

--------------------------

## Defences bypass

1- Post to get 

 - check if the csrf token is validated if the request is get 

2- lack of token 

	- check validation if the token is not present in the request
	- (lw mmso7a asln mn el request)

3- CSRF token is not tied to the user session token 

	- has 2 accounts and swap the csrf tokens without validation if the csrf token and the session token together 

4- Weird method is used

 - try override 	
   	- X-http-method
   	- X-http-method-override
   	- X-method-override

5- CSRF token is duplicated

	- server side does not record the tokens that have been issued 

6- Referrer/Origin check bypass

 - if they don't check if its not there

   	- <meta name="referrer" content="never">

